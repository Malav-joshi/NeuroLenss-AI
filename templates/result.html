<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>NeuroLens AI Results</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    body {
      background: linear-gradient(180deg, #031820 0%, #081f26 100%);
      color: #e6f8f0;
      font-family: 'Inter', sans-serif;
      padding: 40px;
    }
    .container {
      max-width: 1100px;
      margin: auto;
      background: #0c2830;
      padding: 25px;
      border-radius: 15px;
      box-shadow: 0 10px 40px rgba(0,0,0,0.6);
    }
    .header {
      display: flex;
      align-items: center;
      gap: 15px;
      margin-bottom: 20px;
    }
    .header img {
      height: 60px;
    }
    h1 { color: #c8e4ff; }
    .grid {
      display: grid;
      grid-template-columns: 2fr 1fr;
      gap: 25px;
    }
    .img-box img {
      width: 100%;
      border-radius: 10px;
    }
    .info-box, .summary, .doctor-box {
      background: rgba(255,255,255,0.03);
      padding: 20px;
      border-radius: 10px;
      margin-top: 20px;
    }
    select {
      background: #0c2830;
      border: 1px solid #c8e4ff;
      color: #e6f8f0;
      border-radius: 6px;
      padding: 5px;
    }
    a {
      color: #c8e4ff;
      text-decoration: none;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <img src="static/assets/logo.png" alt="logo">
      <h1>NeuroLens AI Results</h1>
    </div>

    <div class="grid">
      <div class="img-box">
        <img src="{{ result_image }}" alt="Detected Retina">
      </div>

      <div class="info-box">
        <p><b>üìÅ File:</b> {{ result_image.split('/')[-1] }}</p>
        <p><b>ü©∏ Detected Lesions:</b> {{ lesion_count }}</p>
        <p><b>üìä Average Confidence:</b> {{ avg_conf }}</p>
        <p><b>‚è∞ Analyzed At:</b> {{ timestamp }}</p>
      </div>
    </div>

    <div class="summary">
      <h2>üß† AI Summary</h2>
      <p id="summaryText">{{ summary_translations['en'] }}</p>

      <label for="langSel">üåê Translate Summary:</label>
      <select id="langSel">
        {% for code, name in languages.items() %}
          <option value="{{ code }}">{{ name }}</option>
        {% endfor %}
      </select>
    </div>

    <div class="doctor-box">
      <h2>üè• Ophthalmologists near {{ city }}</h2>
      {% if doctors %}
        <ul>
        {% for d in doctors %}
          <li><b>{{ d.name }}</b><br>{{ d.address }}<br><a href="{{ d.link }}" target="_blank">View on Map</a></li>
        {% endfor %}
        </ul>
      {% else %}
        <p>No nearby ophthalmologists found.</p>
      {% endif %}
    </div>

    <div style="margin-top:20px;text-align:center;">
      <a href="/">‚¨Ö Back to Upload</a>
    </div>
  </div>

  <script>
    const translations = {{ summary_translations | tojson }};
    const select = document.getElementById("langSel");
    const textBox = document.getElementById("summaryText");
    select.addEventListener("change", (e) => {
      const lang = e.target.value;
      textBox.textContent = translations[lang] || translations["en"];
    });
  </script>
</body>
</html>
